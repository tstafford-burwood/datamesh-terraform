steps:

# CLOUD BUILD SERVICE ACCOUNT IAM ROLES

- id: "terraform init"
  name: hashicorp/terraform:${_TAG}
  dir: 'environment/deployments/wcm-srde/cloudbuild-iam-and-pipelines'
  args: [
    'init',
    '-backend-config=bucket=${_BUCKET}',
    '-backend-config=prefix=${_PREFIX}/cloudbuild-iam-and-pipelines'
  ]

- id: "terraform plan"
  name: hashicorp/terraform:${_TAG}
  dir: 'environment/deployments/wcm-srde/cloudbuild-iam-and-pipelines'
  args: [
    'plan'
  ]

- id: "terraform apply"
  name: hashicorp/terraform:${_TAG}
  dir: 'environment/deployments/wcm-srde/cloudbuild-iam-and-pipelines'
  args: [
    'apply',
    '-auto-approve'
  ]

timeout: 1800s